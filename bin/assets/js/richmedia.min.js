var Richmedia=function(){function a(b,c,d,e,f,g){a.scope=this,this.containerRichmedia=b,this.imgPath=c,this.videoPath=d,this.frameData=e,this.timelineData=g,this.videoObj=f,this.dataRichmedia,this.arrayFrames=[],this.arrayElements=[],this.counterImg=0,this.totalImg=0,this.containerVideo,this.poster,this.arrayBtn=[],this.player,this.firstClick=!0,this.clicktag,this.iteration=0,this.numTween=0,this.lastLabelName,this.configureRichmedia(),this.addListeners()}return a.prototype.configureRichmedia=function(){if(this.dataRichmedia={width:this.containerRichmedia.getAttribute("data-w"),height:this.containerRichmedia.getAttribute("data-h"),bgColor:this.containerRichmedia.getAttribute("data-bg-color"),border:this.containerRichmedia.getAttribute("data-border"),preload:this.containerRichmedia.getAttribute("data-preload"),cover:this.containerRichmedia.getAttribute("data-cover")},this.containerRichmedia.style.width=this.dataRichmedia.width+"px",this.containerRichmedia.style.height=this.dataRichmedia.height+"px",this.containerRichmedia.style.backgroundColor=this.dataRichmedia.bgColor,this.containerRichmedia.style.border=this.dataRichmedia.border,"true"==this.dataRichmedia.cover){var a=document.createElement("div");a.style.backgroundColor=this.dataRichmedia.bgColor,a.style.zIndex=2,a.setAttribute("id","cover"),this.containerRichmedia.appendChild(a)}this.containerVideo=document.createElement("div"),this.containerVideo.setAttribute("id",this.videoObj.containerId),this.containerVideo.style.position="relative",0===this.videoObj.containerAutoAlpha&&(this.containerVideo.style.opacity=0,this.containerVideo.style.visibility="hidden"),this.containerVideo.style.zIndex=4,this.containerRichmedia.appendChild(this.containerVideo),this.poster=new Image,this.poster.src=this.imgPath+"poster.png",this.poster.style.left=this.videoObj.playerPositions.x+"px",this.poster.style.top=this.videoObj.playerPositions.y+"px",this.poster.style.cursor="pointer",this.poster.style.zIndex=2,this.poster.setAttribute("id","poster"),this.poster.setAttribute("data","video1"),this.containerVideo.appendChild(this.poster),this.setVideoAssets();var b=0,c=[];for(var d in this.frameData)this.arrayElements.push(this.frameData[d]),c.push(d.toString()),b++;for(var e=0;e<b;e++)this.totalImg+=this.arrayElements[e].length;for(var f=0;f<b;f++){var g=document.createElement("div");g.classList.add("frame"),g.setAttribute("id",c[f]),this.containerRichmedia.appendChild(g),this.arrayFrames.push(g),this.setImgs(this.arrayFrames[f],this.arrayElements[f])}this.setClickTag()},a.prototype.setImgs=function(b,c){c.forEach(function(c){var d=new Image;d.src=a.scope.imgPath+c,b.appendChild(d);var e=c.indexOf("."),f=c.substr(0,e);d.setAttribute("id",f),d.onload=a.scope.imgLoaded()})},a.prototype.imgLoaded=function(){a.scope.counterImg++,a.scope.counterImg==a.scope.totalImg&&a.scope.createTimeLine()},a.prototype.setVideoAssets=function(){this.videoObj.arrayIdVideos.forEach(function(b,c){var d=document.createElement("video");d.setAttribute("id","video"+(c+1)),d.setAttribute("controls",!0),d.setAttribute("class","player"),d.style.position="absolute",d.style.left=this.videoObj.playerPositions.x+"px",d.style.top=this.videoObj.playerPositions.y+"px",d.style.zIndex=1,d.style.width=this.videoObj.playerWidth,d.style.height=this.videoObj.playerHeight;for(var e=0;e<this.videoObj.arrayExtensions.length;e++){var f=document.createElement("source");f.src=this.videoPath+"video"+(c+1)+"."+this.videoObj.arrayExtensions[e],f.type="video/"+this.videoObj.arrayExtensions[e],d.appendChild(f)}if(a.scope.containerVideo.appendChild(d),void 0!=this.videoObj.arrayBtnSrc){var g=new Image,h=this.videoObj.arrayBtnSrc[c].indexOf("."),i=this.videoObj.arrayBtnSrc[c].substr(0,h);g.src=this.imgPath+this.videoObj.arrayBtnSrc[c],g.style.left=this.videoObj.arrayBtnPosX[c]+"px",g.style.top=this.videoObj.arrayBtnPosY[c]+"px",g.style.cursor="pointer",g.setAttribute("id",i),g.setAttribute("data","video"+(c+1)),a.scope.arrayBtn.push(g),a.scope.containerVideo.appendChild(g)}})},a.prototype.addListeners=function(){this.clicktag.addEventListener("click",a.scope.goClickTag),this.poster.addEventListener("click",a.scope.showVideo);for(var b=0;b<this.arrayBtn.length;b++)this.arrayBtn[b].addEventListener("mouseenter",a.scope.overBtn),this.arrayBtn[b].addEventListener("mouseleave",a.scope.outBtn),this.arrayBtn[b].addEventListener("click",a.scope.showVideo)},a.prototype.overBtn=function(a){TweenMax.to(a.currentTarget,.5,{scale:.9,ease:Back.easeInOut})},a.prototype.outBtn=function(a){TweenMax.to(a.currentTarget,.5,{scale:1,ease:Back.easeInOut})},a.prototype.setClickTag=function(){this.clicktag=document.createElement("div"),this.clicktag.setAttribute("id","clicktag"),this.clicktag.style.position="absolute",this.clicktag.style.width=this.containerRichmedia.style.width,this.clicktag.style.height=this.containerRichmedia.style.height,this.clicktag.style.opacity=0,this.clicktag.style.cursor="pointer",this.clicktag.style.zIndex=3,this.containerRichmedia.appendChild(this.clicktag)},a.prototype.goClickTag=function(){a.scope.firstClick||a.scope.stopVideo(!0),a.scope.videoObj.clicktagFunction()},a.prototype.showVideo=function(b){var c=b.currentTarget.getAttribute("data"),d=document.getElementById(c);a.scope.stopVideo(!1),a.scope.firstClick?(a.scope.firstClick=!1,d.style.zIndex=2,TweenMax.to(a.scope.poster,.5,{autoAlpha:0,onComplete:function(){d.play()}})):(d.style.zIndex=2,d.currentTime=0,d.play())},a.prototype.stopVideo=function(a){document.querySelectorAll(".player").forEach(function(b){b.pause(),a||(b.style.zIndex=1)})},a.prototype.createTimeLine=function(){a.scope.tl=new TimelineMax,a.scope.tl.paused(!0),a.scope.timelineData.arrayTween.forEach(function(b){switch(a.scope.numTween++,a.scope.tl.addLabel("step_"+a.scope.numTween),b.type){case"set":a.scope.tl.add(TweenMax.set(b.id,b.prop),b.delay);break;case"to":a.scope.tl.add(TweenMax.to(b.id,b.time,b.prop),b.delay);break;case"from":a.scope.tl.add(TweenMax.from(b.id,b.time,b.prop),b.delay);break;case"fromTo":a.scope.tl.add(TweenMax.fromTo(b.id,b.time,b.propInit,b.propEnd),b.delay)}}),a.scope.tl.addCallback(function(){a.scope.endTimeLine(a.scope.timelineData.loopIteration,a.scope.timelineData.loopLabelInit)}),void 0==a.scope.timelineData.initLabel||0==a.scope.timelineData.initLabel?a.scope.tl.resume(0):a.scope.tl.resume(a.scope.timelineData.initLabel),void 0!=a.scope.timelineData.addPauseAt&&a.scope.addPauseAt(a.scope.timelineData.addPauseAt)},a.prototype.endTimeLine=function(b,c){if(1!=b){if(b==-1||void 0==b)a.scope.tl.resume(0);else{if(a.scope.iteration++,b>1&&a.scope.iteration==b-1){var d;void 0==a.scope.timelineData.loopLabelEnd||0==a.scope.timelineData.loopLabelEnd?(d=a.scope.tl.getLabelsArray()[a.scope.tl.getLabelsArray().length-1],a.scope.lastLabelName=d.name):(d=a.scope.timelineData.loopLabelEnd,a.scope.lastLabelName=d),a.scope.tl.addPause(a.scope.lastLabelName)}if(a.scope.iteration==b)return}void 0!=c||0==c?a.scope.tl.resume(c):a.scope.tl.resume(0)}},a.prototype.addPauseAt=function(b){a.scope.tl.addPause(b)},a}();